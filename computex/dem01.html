<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="./css/reset.css">
	<link rel="stylesheet" href="./css/swiper-4.3.5.min.css">
	<link rel="stylesheet" href="./css/video-js.css">
	<link rel="stylesheet" href="./css/index.css">

	  <!-- 资源 -->
	  <link rel="stylesheet" type="text/css" href="source/plugin/jdong_topic_customize/medium/css/swiper-4.3.5.min.css">
	  <link href="template/dgstyle2017/common/static/css/video-js.css" rel="stylesheet">
	   <link href="template/dgstyle2017/common/static/fonts/v3.8video/style.css" rel="stylesheet">
	   <link rel="stylesheet" href="source/plugin/jdong_topic_customize/medium/css/index.css">
	<title>台北电脑桌</title>

</head>

<body>
	<div class="computex-warp">
		<!-- banner -->
		<div class="computex-banner">
			<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/xFvZVnlVvdl1Fln.png" alt="">
		</div>
		<div class="computex-banner2">
			<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/q255zgG3577kX7o.png" alt="">
		</div>
		<div class="computex-content">
			<div class="computex-list">
				<!-- 热点必读 -->
				<div class="news" id="news1">
					<div class="title-line">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/H4XHhtI93Iy7lkO.png" alt="">
					</div>
					<div class="title-line2">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/J97mPIJ27921m98.png" alt="">
					</div>
					<div class="computex-list-1">
						<div class="computex-swiper ">
							<div class="swiper-container swiper1">
								<div class="swiper-wrapper">
                                                                        <!--{if $column[1][app]}-->
                                                                        <!--{loop $column[1][app] $value1}-->
									<a class="swiper-slide" href="$value1['url']">
										<img src="$value1['picurl']" alt="$value1['title']">
									</a>
                                                                        <!--{/loop}-->
                                                                        <!--{/if}-->
								</div>
							</div>
							<div class="swiper-pagination"></div>
						</div>
					</div>
				</div>
				<!-- 台妹 Show Girl -->
				<div class="news" id="news2">
					<div class="title-line">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/r9aR9Yua7U727aJ.png" alt="">
					</div>
					<div class="title-line2">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/yGZfFWlyNZADqUW.png" alt="">
					</div>
					<div class="computex-list-1">
						<div class="computex-swiper ">
							<div class="swiper-container swiper1">
								<div class="swiper-wrapper">
                                                                        <!--{if $column[2][app]}-->
                                                                        <!--{loop $column[2][app] $value2}-->
									<div class="swiper-slide">
										<img class="swiper-img" src="http://s1.dgtle.com/forum/201710/26/091932cmv8xa6a5u0t9n8t.jpg" alt="">
										<a href="$value2['url']" class="computex-list-bottom">
											<h3>$value2['title']</h3>
											<p>$value2['content']</p>

										</a>
									</div>
                                                                        <!--{/loop}-->
                                                                        <!--{/if}-->
								</div>
							</div>
							<div class="swiper-pagination2"></div>
							<div class="swiper-button-prev swiper-button-white"></div>
							<div class="swiper-button-next swiper-button-white"></div>
						</div>

					</div>

				</div>
				<!-- 高层观点 -->
				<div class="news " id="news3">
					<div class="title-line">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/L35x3XlVYv1KwJt.png" alt="">
					</div>
					<div class="title-line2">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/POreIEkeOqMEIoE.png" alt="">
					</div>
					<ul class="computex-list-2 computex-list-3">
                                                <!--{if $column[3][app]}-->
                                                <!--{loop $column[3][app] $value3}-->
						<li>
							<div><img src="<!--{$value3['picurl']}-->" alt=""></div>
							<h3>$value3['title']</h3>
							<p>$value3['content']</p>
						</li>
                                                <!--{/loop}-->
                                                 <!--{/if}-->
					</ul>
				</div>
				<!-- 视频报道 -->
				<div class="news " id="news4">
					<div class="title-line">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/CFRRpFQe2P7Wm6n.png" alt="">
					</div>
					<div class="title-line2">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/cM392RrMcTcP3EH.png" alt="">
					</div>
					<ul class="computex-list-2 computex-list-4">
                                                <!--{if $column[4][app]}-->
                                                <!--{loop $column[4][app] $value4}-->
						<li class="<!--{if $value4['summary']=='短视频'}-->video1<!--{else}-->video2<!--{/if}-->" data-video="$value4['extra_picurl']">
							<span class="title"><i class=" bg"></i>$value4['summary']</span>
							<div><img src="$value4['picurl']" alt=""></div>
							<h3>$value4['title']</h3>
						</li>
                                                <!--{/loop}-->
                                                <!--{/if}-->
					</ul>
				</div>
				<!-- 尾巴教你选 -->
				<div class="news " id="news5">
					<div class="title-line">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/d21qc40pZ06Z2rg.png" alt="">
					</div>
					<div class="title-line2">
						<img src="http://s1.dgtle.com/jdong_plugin_public/topic_medium/image/p3L4V4Ovg4F2uzu.png" alt="">
					</div>
					<ul class="computex-list-2 computex-list-3 computex-list-5">
                                                <!--{if $column[5][app]}-->
                                                <!--{loop $column[5][app] $value5}-->
						<li>
							<div><img src="<!--{$value5['picurl']}-->" alt=""></div>
							<h3>$value5['title']</h3>
							<p>$value5['content']</p>
						</li>
                                                 <!--{/loop}-->
                                                 <!--{/if}-->
					</ul>
				</div>
			</div>
			<div class="computex-nav">
				<div class="nav">
					<div class="nav-1">
						<span>尾巴在现场</span>
						<a href="#news1" class="navactive active"><i class="bg bg1"></i>热点必读</a>
						<a href="#news2" class="navactive"><i class="bg bg2"></i>台妹 Show Girl</a>
						<a href="#news3" class="navactive"><i class="bg bg3"></i>高层观点</a>
						<a href="#news4" class="navactive"><i class="bg bg4"></i>视频报道</a>
						<a href="#news5" class="navactive"><i class="bg bg6"></i>尾巴教你挑</a>
					</div>
				</div>
			</div>
			<div class=" computex-nav2 swiper-container2">
				<div class="nav swiper-wrapper">
					<div class="swiper-slide ">
						<a href="#news1" class="navactive active">热点必读</a>
					</div>
					<div class="swiper-slide ">
						<a href="#news2" class="swiper-slide navactive">台妹 Show Girl</a>
					</div>
					<div class="swiper-slide ">
						<a href="#news3" class="swiper-slide navactive">高层观点</a>
					</div>
					<div class="swiper-slide ">
						<a href="#news4" class="swiper-slide navactive">视频报道</a>
					</div>
					<div class="swiper-slide ">
						<a href="#news5" class="swiper-slide navactive">尾巴教你挑</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>
<script src="./js/jquery-1.11.3.js"></script>
<script src="./js/swiper-4.3.5.min.js"></script>
<script src="./js/video.min.js"></script>
<!-- 资源 -->
<script src="template/dgstyle2017/common/static/scripts/lib/video.min.js"></script>
<script type="text/javascript" src="source/plugin/jdong_topic_customize/medium/js/swiper-4.3.5.min.js" ></script>
<script>
	// 通过缩放属性适应各个宽度的平板
	var s = document.body.clientWidth;
	var scale = s / 1250;
	var meta = document.getElementsByTagName('meta');
	if (s < 1250 && s > 700) {
		meta[1].setAttribute('content', "width=device-width, initial-scale=" + scale + ", minimum-scale=" + scale + ", maximum-scale=2.0");
	}

	var ua = navigator.userAgent;
	var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
		isIphone = ua.match(/(iPhone\sOS)\s([\d_]+)/),
		isAndroid = ua.match(/(Android)\s+([\d.]+)/),
		isMobile = isIphone || isAndroid;

	var flag = true //设置标识。防止出现跑马灯  
	var winH = jQuery(window).innerHeight() / 2;
	if (isMobile) {
		jQuery('.computex-warp').addClass('computexMobile');
		jQuery('html').css('font-size', '625%');
		jQuery('body').css('font-size', '0.16rem');
		jQuery(".computex-nav2 .navactive").click(function () {
			flag = false;
			jQuery(".computex-nav2 .nav .navactive").removeClass("active");
			jQuery(this).addClass("active");
			var index = jQuery(this).attr('href'); //获取当前点击元素的索引  

			var top = jQuery(index).offset().top; //获取每个banner到顶部的距离  
			jQuery("html,body").stop(true).animate({
				"scrollTop": top - 100
			}, 1000, function () {
				flag = true
			})
		})
		var mySwiper = new Swiper('.swiper-container2', {
			autoplay: false, //可选选项，自动滑动
			slidesPerView: 'auto',
			spaceBetween: 0,
			slidesOffsetAfter: 0,
			centerInsufficientSlides: true,
		})
	} else {

		jQuery(".computex-nav .navactive").click(function () {
			flag = false;
			jQuery(".computex-nav .nav .navactive").removeClass("active");
			jQuery(this).addClass("active");
			var index = jQuery(this).attr('href'); //获取当前点击元素的索引  

			var top = jQuery(index).offset().top; //获取每个banner到顶部的距离  
			jQuery("html,body").stop(true).animate({
				"scrollTop": top - 100
			}, 1000, function () {
				flag = true
			})
		})

	}

	for (var i = 0; i < jQuery('#news1 .computex-list-1').length; i++) {
		var mySwiper2 = new Swiper(jQuery('#news1 .computex-list-1').eq(i).find('.swiper-container'), {
			speed: 1000,
			// autoplay : {
			//     delay:3000
			// },
			pagination: {
				el: jQuery('#news1 .computex-list-1').eq(i).find('.swiper-pagination'),
				// clickable: true,
				renderBullet: function (index, className) {
                    return '<a target="_black" href="'+jQuery('#news1 .computex-list-1').eq(i).find('.swiper-container .swiper-slide').eq(index).attr('href')+'" class="' + className + '">' + jQuery('#news1 .computex-list-1').eq(i).find('.swiper-container .swiper-slide').eq(index).find('img').attr('alt') + '</a>';
					// return '<span class="' + className + '">' + jQuery('#news1 .computex-list-1').eq(i).find('.swiper-container .swiper-slide').eq(index).find('img').attr('alt') + '</span>';
				},
			},
			loop: true,
		})
		new Swiper(jQuery('#news2 .computex-list-1').eq(i).find('.swiper-container'), {
			speed: 1000,
			effect : 'fade',
			pagination: {
				el: jQuery('#news2 .computex-list-1').eq(i).find('.swiper-pagination2'),
				clickable: true,
			},
			navigation: {
				nextEl: jQuery('#news2 .computex-list-1').eq(i).find('.swiper-button-next'),
				prevEl: jQuery('#news2 .computex-list-1').eq(i).find('.swiper-button-prev'),
			},
		})
        for(i=0;i<mySwiper2.pagination.bullets.length;i++){
			mySwiper2.pagination.bullets[i].index=i
			mySwiper2.pagination.bullets[i].onmouseover=function(){
				mySwiper2.slideTo(this.index+1);
			};
			}
		jQuery('#news1 .computex-list-1').eq(i).find('.swiper-pagination .swiper-pagination-bullet').hover(function () {
			jQuery(this).click(); //鼠标划上去之后，自动触发点击事件来模仿鼠标划上去的事件
		}, function () {
			// mySwiper.autoplay.start(); //鼠标移出之后，自动轮播开启
		})
	}

	jQuery(window).scroll(function () {
		var scrollT = jQuery(window).scrollTop();
		if (jQuery('.computex-list').offset().top < scrollT + 60) {
			jQuery('.nav').addClass('nav-fixed');
		} else {
			jQuery('.nav').removeClass('nav-fixed');
		}
		if (flag) {
			//浏览器可视窗口的一半，也可以根据自己需求设定  
			var len = jQuery(".news").size()
			for (var i = 0; i < len; i++) {
				var bannerGap = jQuery(".news")[i].offsetTop - scrollT;
				if (bannerGap < winH) {
					if (isMobile) {
						jQuery(".computex-nav2 .nav .navactive").removeClass("active");
						jQuery(".computex-nav2 .navactive").eq(i).addClass("active");
						mySwiper.slideTo(i, 1000, false); //切换到第一个slide，速度为1秒
					} else {
						jQuery(".computex-nav .nav .navactive").removeClass("active");
						jQuery(".computex-nav .navactive").eq(i).addClass("active");
					}

				}
			}

		}
	})

	//    视频实例化的方法
	function videoCallBack(elem) {
		var videoArr = []
		jQuery(elem).each(function (i, el) {
			videoArr.push(videojs(el))
		})
		jQuery(elem).each(function (i, id) {
			// videojs(id, {}, function () { //自动播放
			// var myPlayer = videojs(id);
			videojs(id).ready(function () {
				var that = this;
				var tempProgress = jQuery('<div class="tempProgressG">' +
					'<div class="tempProgress">' +
					'</div>')
				jQuery(id).append(tempProgress)
				console.log('s')
				that.on('timeupdate', function () {
					tempProgress = jQuery(id).find('.tempProgress')
					var width = this.currentTime() / this.duration() * 100 + '%'
					tempProgress.css({
						width: width,
						background: '#4CA6E1'
					})
				})
				that.on('play', function () {
					videoArr.filter(x => x != that).forEach(function (video) {
						video.pause()
					})
				})
			});
		})

	}

	jQuery('#news4 ul li').click(function () {
		console.log('3')
		var videosrc = jQuery(this).attr('data-video');
		var imgsrc = jQuery(this).find('img').attr('src');
		var msg = jQuery(this).find('h3').html();
		if (isMobile && isIphone) {
			var ver = (navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);
			ver = parseInt(ver[1], 10);
			console.log(ver)
		}
		if (ver >= 12) {
			window.open(videosrc, '_blank')
			// window.location.href=videosrc;
		} else {
			jQuery('body .computex-warp').append('<div class="awe-1-video-w">' +
				'<div class="awe-1-video">' +
				'<video id="example_video_1" class="video-js vjs-default-skin" controls preload="none" width="400" height="255"' +
				'poster="' + imgsrc + '"' +
				'data-setup="{}">' +
				'<source type="video/mp4" src="' + videosrc + '"  /> ' +
				'<source type="video/webm" src="' + videosrc + '"  />' +
				'<source type="video/ogg" src="' + videosrc + '"  />' +
				'</video>' +
				'<div class="awe-1-msg">' + msg + '</div>' +
				'<div class="awe-close">x</div>' +
				'</div>' +
				'</div>');
			videoCallBack('.video-js')
		}

	})
	jQuery('body').on('click', '.awe-1-video-w .awe-close', function () {
		jQuery('.awe-1-video-w').remove();
	})
</script>